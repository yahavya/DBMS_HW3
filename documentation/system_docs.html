<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>System Documentation</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
            background: #f5f5f5;
        }

        .container {
            background: white;
            padding: 60px;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }

        h1 {
            color: #2c3e50;
            font-size: 2em;
            margin-bottom: 10px;
            border-bottom: 4px solid #3498db;
            padding-bottom: 15px;
        }

        h2 {
            color: #34495e;
            font-size: 1.8em;
            margin-top: 40px;
            margin-bottom: 20px;
            border-left: 5px solid #3498db;
            padding-left: 15px;
        }

        h3 {
            color: #2c3e50;
            font-size: 1.3em;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .subtitle {
            color: #7f8c8d;
            font-size: 1.1em;
            margin-bottom: 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .stat-card h4 {
            font-size: 0.9em;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .stat-card .number {
            font-size: 2.5em;
            font-weight: bold;
        }

        .table-container {
            overflow-x: auto;
            margin: 20px 0;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
        }

        th {
            background: #34495e;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: 600;
        }

        td {
            padding: 10px 12px;
            border-bottom: 1px solid #ecf0f1;
        }

        tr:hover {
            background: #f8f9fa;
        }

        .sql-code {
            background: #2c3e50;
            color: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            overflow-x: auto;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.5;
            margin: 15px 0;
            white-space: pre-wrap;
        }

        .sql-keyword {
            color: #3498db;
            font-weight: bold;
        }

        .sql-string {
            color: #2ecc71;
        }

        .sql-comment {
            color: #95a5a6;
            font-style: italic;
        }

        .result-box {
            background: #ecf0f1;
            padding: 20px;
            border-radius: 5px;
            margin: 15px 0;
            border-left: 4px solid #3498db;
        }

        .result-item {
            padding: 8px 0;
            border-bottom: 1px solid #bdc3c7;
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .er-diagram {
            margin: 30px 0;
            padding: 30px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        .table-box {
            background: white;
            border: 2px solid #3498db;
            border-radius: 8px;
            padding: 15px;
            margin: 15px;
            display: inline-block;
            min-width: 200px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .table-name {
            font-weight: bold;
            color: #2c3e50;
            font-size: 1.1em;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 2px solid #3498db;
        }

        .table-field {
            font-size: 0.85em;
            color: #555;
            padding: 3px 0;
        }

        .pk {
            color: #e74c3c;
            font-weight: bold;
        }

        .fk {
            color: #f39c12;
            font-style: italic;
        }

        .relationship {
            color: #7f8c8d;
            font-size: 0.9em;
            margin: 10px 0;
            font-style: italic;
        }

        .highlight {
            background: #fff3cd;
            padding: 2px 5px;
            border-radius: 3px;
        }

        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.85em;
            margin: 2px;
        }

        .badge-fulltext {
            background: #3498db;
            color: white;
        }

        .badge-btree {
            background: #3498db;
            color: white;
        }

        .badge-complex {
            background: #e74c3c;
            color: white;
        }

        .index-list {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
        }

        .index-item {
            padding: 8px;
            margin: 5px 0;
            background: white;
            border-left: 3px solid #3498db;
            padding-left: 15px;
        }

        @media print {
            body {
                background: white;
            }
            .container {
                box-shadow: none;
            }
            .sql-code {
                background: #f5f5f5;
                color: #2c3e50;
                border: 1px solid #ddd;
                white-space: pre-wrap;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>
            System Documentation
        </h1>
        <p class="subtitle">Database Management Systems - Assignment 3</p>
        <p class="authors"><strong>Authors:</strong> Saar Molina &amp; Yaron Yahav</p>
        <p><strong>Date:</strong> January 18, 2026</p>

        <!-- DATABASE OVERVIEW -->
        <h2>1. Database Overview</h2>
        <p>Our project is a comprehensive movie discovery database that stores movie information from The Movie Database (TMDb) API. The database is designed to support queries for finding movies by keywords, analyzing genre performance, discovering actor collaborations, and exploring director filmographies.</p>

        <div class="stats-grid">
            <div class="stat-card">
                <h4>Total Records</h4>
                <div class="number">15,696</div>
            </div>
            <div class="stat-card">
                <h4>Movies</h4>
                <div class="number">495</div>
            </div>
            <div class="stat-card">
                <h4>People (Actors/Directors)</h4>
                <div class="number">5,452</div>
            </div>
        </div>

        <!-- RECORD COUNTS -->
        <h3>1.1 Record Distribution by Table</h3>
        
        <table>
            <thead>
                <tr>
                    <th>Table Name</th>
                    <th>Record Count</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>movies</strong></td>
                    <td>495</td>
                    <td>Core movie information (title, rating, revenue, etc.)</td>
                </tr>
                <tr>
                    <td><strong>genres</strong></td>
                    <td>19</td>
                    <td>Movie genre categories from TMDb</td>
                </tr>
                <tr>
                    <td><strong>movie_genres</strong></td>
                    <td>1,391</td>
                    <td>Junction table linking movies to genres (many-to-many)</td>
                </tr>
                <tr>
                    <td><strong>people</strong></td>
                    <td>5,452</td>
                    <td>Actors, directors, and crew members</td>
                </tr>
                <tr>
                    <td><strong>movie_cast</strong></td>
                    <td>3,922</td>
                    <td>Actor appearances in movies with character names</td>
                </tr>
                <tr>
                    <td><strong>movie_crew</strong></td>
                    <td>4,417</td>
                    <td>Directors, producers, writers for each movie</td>
                </tr>
            </tbody>
        </table>

        <!-- DATABASE SCHEMA -->
        <h2>2. Database Schema Design</h2>

        <h3>2.1 Entity-Relationship Overview</h3>
        <div class="er-diagram" style="text-align: center; overflow-x: auto;">
            <svg width="900" height="450" viewBox="0 0 900 450" xmlns="http://www.w3.org/2000/svg">
                <defs>
                    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
                        <path d="M0,0 L0,6 L9,3 z" fill="#7f8c8d" />
                    </marker>
                    <marker id="crowsfoot" markerWidth="12" markerHeight="12" refX="12" refY="6" orient="auto">
                        <path d="M0,0 L12,6 L0,12 M12,6 L0,6" stroke="#7f8c8d" stroke-width="1.5" fill="none"/>
                    </marker>
                </defs>

                <style>
                    .table-rect { fill: #ffffff; stroke: #3498db; stroke-width: 2px; filter: drop-shadow(2px 2px 2px rgba(0,0,0,0.1)); }
                    .table-header { font-family: sans-serif; font-weight: bold; font-size: 14px; fill: #2c3e50; }
                    .table-text { font-family: sans-serif; font-size: 11px; fill: #555; }
                    .pk-text { font-weight: bold; fill: #e74c3c; }
                    .fk-text { font-style: italic; fill: #f39c12; }
                    .line { stroke: #7f8c8d; stroke-width: 2px; }
                </style>

                <g transform="translate(350, 150)">
                    <rect class="table-rect" width="160" height="130" rx="5" ry="5"/>
                    <text x="80" y="20" text-anchor="middle" class="table-header">movies</text>
                    <line x1="0" y1="30" x2="160" y2="30" stroke="#3498db" stroke-width="1"/>
                    <text x="10" y="50" class="table-text pk-text">PK movie_id</text>
                    <text x="10" y="70" class="table-text">title, overview</text>
                    <text x="10" y="90" class="table-text">release_date</text>
                    <text x="10" y="110" class="table-text">revenue, rating</text>
                </g>

                <g transform="translate(20, 180)">
                    <rect class="table-rect" width="120" height="70" rx="5" ry="5"/>
                    <text x="60" y="20" text-anchor="middle" class="table-header">genres</text>
                    <line x1="0" y1="30" x2="120" y2="30" stroke="#3498db" stroke-width="1"/>
                    <text x="10" y="50" class="table-text pk-text">PK genre_id</text>
                    <text x="10" y="65" class="table-text">name</text>
                </g>

                <g transform="translate(190, 180)">
                    <rect class="table-rect" width="120" height="70" rx="5" ry="5"/>
                    <text x="60" y="20" text-anchor="middle" class="table-header">movie_genres</text>
                    <line x1="0" y1="30" x2="120" y2="30" stroke="#3498db" stroke-width="1"/>
                    <text x="10" y="50" class="table-text pk-text fk-text">PK,FK movie_id</text>
                    <text x="10" y="65" class="table-text pk-text fk-text">PK,FK genre_id</text>
                </g>

                <g transform="translate(760, 180)">
                    <rect class="table-rect" width="120" height="70" rx="5" ry="5"/>
                    <text x="60" y="20" text-anchor="middle" class="table-header">people</text>
                    <line x1="0" y1="30" x2="120" y2="30" stroke="#3498db" stroke-width="1"/>
                    <text x="10" y="50" class="table-text pk-text">PK person_id</text>
                    <text x="10" y="65" class="table-text">name</text>
                </g>

                <g transform="translate(560, 60)">
                    <rect class="table-rect" width="150" height="100" rx="5" ry="5"/>
                    <text x="75" y="20" text-anchor="middle" class="table-header">movie_cast</text>
                    <line x1="0" y1="30" x2="150" y2="30" stroke="#3498db" stroke-width="1"/>
                    <text x="10" y="50" class="table-text pk-text">PK id</text>
                    <text x="10" y="70" class="table-text fk-text">FK movie_id</text>
                    <text x="10" y="90" class="table-text fk-text">FK person_id</text>
                </g>

                <g transform="translate(560, 280)">
                    <rect class="table-rect" width="150" height="100" rx="5" ry="5"/>
                    <text x="75" y="20" text-anchor="middle" class="table-header">movie_crew</text>
                    <line x1="0" y1="30" x2="150" y2="30" stroke="#3498db" stroke-width="1"/>
                    <text x="10" y="50" class="table-text pk-text">PK id</text>
                    <text x="10" y="70" class="table-text fk-text">FK movie_id</text>
                    <text x="10" y="90" class="table-text fk-text">FK person_id</text>
                </g>

                <line x1="140" y1="215" x2="190" y2="215" class="line" marker-end="url(#crowsfoot)" />
                <text x="150" y="205" font-size="10" fill="#555">1</text>
                <text x="180" y="205" font-size="10" fill="#555">N</text>

                <line x1="350" y1="215" x2="310" y2="215" class="line" marker-end="url(#crowsfoot)" />
                <text x="340" y="205" font-size="10" fill="#555">1</text>
                <text x="320" y="205" font-size="10" fill="#555">N</text>

                <line x1="430" y1="150" x2="430" y2="110" class="line" />
                <line x1="430" y1="110" x2="560" y2="110" class="line" marker-end="url(#crowsfoot)" />
                <text x="440" y="145" font-size="10" fill="#555">1</text>
                <text x="550" y="100" font-size="10" fill="#555">N</text>

                <line x1="820" y1="180" x2="820" y2="110" class="line" />
                <line x1="820" y1="110" x2="710" y2="110" class="line" marker-end="url(#crowsfoot)" />
                <text x="830" y="170" font-size="10" fill="#555">1</text>
                <text x="720" y="100" font-size="10" fill="#555">N</text>

                <line x1="430" y1="280" x2="430" y2="330" class="line" />
                <line x1="430" y1="330" x2="560" y2="330" class="line" marker-end="url(#crowsfoot)" />
                <text x="440" y="295" font-size="10" fill="#555">1</text>
                <text x="550" y="320" font-size="10" fill="#555">N</text>

                <line x1="820" y1="250" x2="820" y2="330" class="line" />
                <line x1="820" y1="330" x2="710" y2="330" class="line" marker-end="url(#crowsfoot)" />
                <text x="830" y="265" font-size="10" fill="#555">1</text>
                <text x="720" y="320" font-size="10" fill="#555">N</text>

            </svg>
        </div>

        <h3>2.1.1 Relationship Summary</h3>

        <div class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Entity1</th>
                        <th>Entity2</th>
                        <th>Cardinality</th>
                        <th>Link Table</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Movies</td>
                        <td>Genres</td>
                        <td>Many-to-Many</td>
                        <td>movie_genres</td>
                    </tr>
                    <tr>
                        <td>Movies</td>
                        <td>People</td>
                        <td>Many-to-Many</td>
                        <td>movie_cast</td>
                    </tr>
                    <tr>
                        <td>Movies</td>
                        <td>People</td>
                        <td>Many-to-Many</td>
                        <td>movie_crew</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <h3>2.2 Table Schemas</h3>

        <h4>Table: movies</h4>
        <table>
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Type</th>
                    <th>Null</th>
                    <th>Key</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>movie_id</strong></td>
                    <td>INT</td>
                    <td>NO</td>
                    <td>PRI</td>
                    <td>Primary key from TMDb API</td>
                </tr>
                <tr>
                    <td>title</td>
                    <td>VARCHAR(255)</td>
                    <td>NO</td>
                    <td>MUL</td>
                    <td>Movie title (indexed for full-text search)</td>
                </tr>
                <tr>
                    <td>overview</td>
                    <td>TEXT</td>
                    <td>YES</td>
                    <td>MUL</td>
                    <td>Movie plot summary (indexed for full-text search)</td>
                </tr>
                <tr>
                    <td>release_date</td>
                    <td>DATE</td>
                    <td>YES</td>
                    <td>MUL</td>
                    <td>Release date (indexed for filtering)</td>
                </tr>
                <tr>
                    <td>runtime</td>
                    <td>INT</td>
                    <td>YES</td>
                    <td></td>
                    <td>Duration in minutes</td>
                </tr>
                <tr>
                    <td>budget</td>
                    <td>BIGINT</td>
                    <td>YES</td>
                    <td></td>
                    <td>Production budget in USD</td>
                </tr>
                <tr>
                    <td>revenue</td>
                    <td>BIGINT</td>
                    <td>YES</td>
                    <td></td>
                    <td>Total box office revenue in USD</td>
                </tr>
                <tr>
                    <td>vote_average</td>
                    <td>DECIMAL(3,1)</td>
                    <td>YES</td>
                    <td>MUL</td>
                    <td>Average rating 0-10 (indexed for filtering)</td>
                </tr>
                <tr>
                    <td>vote_count</td>
                    <td>INT</td>
                    <td>YES</td>
                    <td></td>
                    <td>Number of ratings</td>
                </tr>
                <tr>
                    <td>popularity</td>
                    <td>DECIMAL(10,3)</td>
                    <td>YES</td>
                    <td></td>
                    <td>TMDb popularity score</td>
                </tr>
                <tr>
                    <td>original_language</td>
                    <td>VARCHAR(10)</td>
                    <td>YES</td>
                    <td></td>
                    <td>ISO 639-1 language code</td>
                </tr>
            </tbody>
        </table>

        <h4>Table: genres</h4>
        <table>
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Type</th>
                    <th>Null</th>
                    <th>Key</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>genre_id</strong></td>
                    <td>INT</td>
                    <td>NO</td>
                    <td>PRI</td>
                    <td>Primary key from TMDb API</td>
                </tr>
                <tr>
                    <td>genre_name</td>
                    <td>VARCHAR(100)</td>
                    <td>NO</td>
                    <td></td>
                    <td>Genre name (e.g., Action, Drama, Comedy)</td>
                </tr>
            </tbody>
        </table>

        <h4>Table: movie_genres (Junction Table)</h4>
        <table>
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Type</th>
                    <th>Null</th>
                    <th>Key</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>movie_id</strong></td>
                    <td>INT</td>
                    <td>NO</td>
                    <td>PRI, FK</td>
                    <td>Foreign key to movies.movie_id</td>
                </tr>
                <tr>
                    <td><strong>genre_id</strong></td>
                    <td>INT</td>
                    <td>NO</td>
                    <td>PRI, FK</td>
                    <td>Foreign key to genres.genre_id</td>
                </tr>
            </tbody>
        </table>

        <h4>Table: people</h4>
        <table>
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Type</th>
                    <th>Null</th>
                    <th>Key</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>person_id</strong></td>
                    <td>INT</td>
                    <td>NO</td>
                    <td>PRI</td>
                    <td>Primary key from TMDb API</td>
                </tr>
                <tr>
                    <td>name</td>
                    <td>VARCHAR(255)</td>
                    <td>NO</td>
                    <td>MUL</td>
                    <td>Full name (indexed for search)</td>
                </tr>
                <tr>
                    <td>popularity</td>
                    <td>DECIMAL(10,3)</td>
                    <td>YES</td>
                    <td></td>
                    <td>TMDb popularity score</td>
                </tr>
            </tbody>
        </table>

        <h4>Table: movie_cast</h4>
        <table>
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Type</th>
                    <th>Null</th>
                    <th>Key</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>id</strong></td>
                    <td>INT</td>
                    <td>NO</td>
                    <td>PRI</td>
                    <td>Auto-increment primary key</td>
                </tr>
                <tr>
                    <td>movie_id</td>
                    <td>INT</td>
                    <td>YES</td>
                    <td>MUL, FK</td>
                    <td>Foreign key to movies.movie_id</td>
                </tr>
                <tr>
                    <td>person_id</td>
                    <td>INT</td>
                    <td>YES</td>
                    <td>MUL, FK</td>
                    <td>Foreign key to people.person_id</td>
                </tr>
                <tr>
                    <td>character_name</td>
                    <td>VARCHAR(255)</td>
                    <td>YES</td>
                    <td></td>
                    <td>Character name in the movie</td>
                </tr>
                <tr>
                    <td>cast_order</td>
                    <td>INT</td>
                    <td>YES</td>
                    <td>MUL</td>
                    <td>Billing order (0 = top billed, indexed)</td>
                </tr>
            </tbody>
        </table>

        <h4>Table: movie_crew</h4>
        <table>
            <thead>
                <tr>
                    <th>Field</th>
                    <th>Type</th>
                    <th>Null</th>
                    <th>Key</th>
                    <th>Description</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>id</strong></td>
                    <td>INT</td>
                    <td>NO</td>
                    <td>PRI</td>
                    <td>Auto-increment primary key</td>
                </tr>
                <tr>
                    <td>movie_id</td>
                    <td>INT</td>
                    <td>YES</td>
                    <td>MUL, FK</td>
                    <td>Foreign key to movies.movie_id</td>
                </tr>
                <tr>
                    <td>person_id</td>
                    <td>INT</td>
                    <td>YES</td>
                    <td>MUL, FK</td>
                    <td>Foreign key to people.person_id</td>
                </tr>
                <tr>
                    <td>job</td>
                    <td>VARCHAR(100)</td>
                    <td>YES</td>
                    <td></td>
                    <td>Job title (Director, Producer, Writer, etc.)</td>
                </tr>
                <tr>
                    <td>department</td>
                    <td>VARCHAR(100)</td>
                    <td>YES</td>
                    <td></td>
                    <td>Department (Directing, Production, Writing)</td>
                </tr>
            </tbody>
        </table>

        <!-- INDEX STRATEGY -->
        <h2>3. Index Strategy</h2>
        <p>Strategic indices have been created to optimize query performance. The database uses both FULLTEXT indices for natural language search and B-tree indices for efficient filtering and joins.</p>

        <div class="index-list">
            <div class="index-item">
                <span class="badge badge-fulltext">FULLTEXT</span>
                <strong>idx_movie_overview</strong> (FULLTEXT on movies.overview)<br>
                <p>Enables full-text search on movie descriptions for Query 1. Supports natural language keyword matching with relevance scoring.</p>
            </div>

            <div class="index-item">
                <span class="badge badge-fulltext">FULLTEXT</span>
                <strong>idx_movie_title</strong> (FULLTEXT on movies.title)<br>
                <p>Enables full-text search on movie titles for Query 2. Supports fuzzy title matching.</p>
            </div>

            <div class="index-item">
                <span class="badge badge-btree">B-tree</span>
                <strong>idx_movie_vote_average</strong> (B-tree on movies.vote_average)<br>
                <p>Optimizes filtering movies by rating threshold in Query 3 and Query 5.</p>
            </div>

            <div class="index-item">
                <span class="badge badge-btree">B-tree</span>
                <strong>idx_movie_release_date</strong> (B-tree on movies.release_date)<br>
                <p>Optimizes time-based queries and year extraction operations.</p>
            </div>

            <div class="index-item">
                <span class="badge badge-btree">B-tree</span>
                <strong>idx_movie_cast_person</strong> (B-tree on movie_cast.person_id)<br>
                <p>Optimizes joins between movie_cast and people tables in Query 4.</p>
            </div>

            <div class="index-item">
                <span class="badge badge-btree">B-tree</span>
                <strong>idx_movie_cast_order</strong> (B-tree on movie_cast.cast_order)<br>
                <p>Optimizes filtering top-billed actors in Query 5.</p>
            </div>

            <div class="index-item">
                <span class="badge badge-btree">B-tree</span>
                <strong>idx_movie_crew_person_job</strong> (Composite B-tree on movie_crew.person_id, movie_crew.job)<br>
                <p>Optimizes director lookups in Query 5. Composite index covers both person and job filter.</p>
            </div>

            <div class="index-item">
                <span class="badge badge-btree">B-tree</span>
                <strong>idx_movie_genres_genre</strong> (B-tree on movie_genres.genre_id)<br>
                <p>Optimizes genre-based joins in Query 3.</p>
            </div>

            <div class="index-item">
                <span class="badge badge-btree">B-tree</span>
                <strong>idx_people_name</strong> (B-tree on people.name)<br>
                <p>Optimizes name-based searches in Query 4 and Query 5.</p>
            </div>
        </div>

        <!-- DESIGN DECISIONS -->
        <h2>3.1 Database Design Decisions and Rationale</h2>

        <h3>Normalization Strategy</h3>
        <p>The database follows <strong>Third Normal Form (3NF)</strong> principles to minimize redundancy and maintain data integrity:</p>

        <div class="index-list">
            <div class="index-item">
                <strong>Separate People Table</strong><br>
                <p>Rather than duplicating person information in both movie_cast and movie_crew tables, we created a single <code>people</code> table. This prevents data duplication when the same person appears as both actor and director (e.g., Clint Eastwood).</p>
                <p><em>Alternative Considered:</em> Separate actors and directors tables. Rejected due to significant duplication and difficulty handling multi-role individuals.</p>
            </div>

            <div class="index-item">
                <strong>Junction Table for Genres</strong><br>
                <p>The <code>movie_genres</code> junction table implements the many-to-many relationship between movies and genres. Each movie can have multiple genres, and each genre applies to multiple movies.</p>
                <p><em>Alternative Considered:</em> Store genres as comma-separated values in movies table. Rejected because it breaks 1NF, prevents efficient querying, and complicates genre-based analytics.</p>
            </div>

            <div class="index-item">
                <strong>Separate Cast and Crew Tables</strong><br>
                <p>Instead of a single "person_in_movie" table, we separated <code>movie_cast</code> (actors) and <code>movie_crew</code> (directors, producers, writers) because they have different attributes:</p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li>Cast needs: character_name, cast_order (billing)</li>
                    <li>Crew needs: job, department</li>
                </ul>
                <p><em>Alternative Considered:</em> Single "participation" table with nullable columns. Rejected due to sparse matrix problem and unclear semantics.</p>
            </div>
        </div>

        <h3>Performance Optimizations</h3>
        <div class="index-list">
            <div class="index-item">
                <strong>Composite Index on movie_crew</strong><br>
                <p>Created composite index on (person_id, job) rather than separate indices because Query 5 always filters directors by both person and job simultaneously. The composite index covers both conditions in a single lookup.</p>
            </div>

            <div class="index-item">
                <strong>FULLTEXT Indices on movies table</strong><br>
                <p>Used MySQL's FULLTEXT indexing for natural language search on title and overview rather than LIKE queries. FULLTEXT provides:</p>
                <ul style="margin-left: 20px; margin-top: 10px;">
                    <li>Relevance scoring (ranking results by match quality)</li>
                    <li>Word-based matching (not just substring)</li>
                    <li>10-100x faster than LIKE '%keyword%' on large text fields</li>
                </ul>
            </div>

            <div class="index-item">
                <strong>Foreign Key Constraints with CASCADE</strong><br>
                <p>All foreign keys use ON DELETE CASCADE to maintain referential integrity. If a movie is deleted, all associated cast, crew, and genre relationships are automatically removed, preventing orphaned records.</p>
            </div>
        </div>

        <!-- QUERIES -->
        <h2>4. Database Queries</h2>
        <p>Our project implements 5 main queries: 2 FULLTEXT searches and 3 complex queries with aggregation, grouping, and nested subqueries.</p>

        <!-- QUERY 1 -->
        <h3>4.1 Query 1: Full-Text Search by Movie Overview</h3>
        <p><span class="badge badge-fulltext">FULLTEXT</span></p>
        <p><strong>Purpose:</strong> Find movies whose plot descriptions contain specific keywords, ordered by relevance and rating.</p>
        <p><strong>Use Case:</strong> User searches for "space" to find all space-themed movies like Interstellar, WALL·E, etc.</p>

        <div class="sql-code">
<span class="sql-keyword">SELECT</span>
    m.title,
    m.vote_average <span class="sql-keyword">AS</span> rating,
    <span class="sql-keyword">YEAR</span>(m.release_date) <span class="sql-keyword">AS</span> year,
    <span class="sql-keyword">LEFT</span>(m.overview, 150) <span class="sql-keyword">AS</span> overview_snippet,
    <span class="sql-keyword">MATCH</span>(m.overview) <span class="sql-keyword">AGAINST</span>(<span class="sql-string">'space'</span>) <span class="sql-keyword">AS</span> relevance_score
<span class="sql-keyword">FROM</span>
    movies m
<span class="sql-keyword">WHERE</span>
    <span class="sql-keyword">MATCH</span>(m.overview) <span class="sql-keyword">AGAINST</span>(<span class="sql-string">'space'</span> <span class="sql-keyword">IN NATURAL LANGUAGE MODE</span>)
<span class="sql-keyword">ORDER BY</span>
    relevance_score <span class="sql-keyword">DESC</span>,
    m.vote_average <span class="sql-keyword">DESC</span>
<span class="sql-keyword">LIMIT</span> 20;
        </div>

        <p><strong>Index Used:</strong> <span class="highlight">idx_movie_overview</span> (FULLTEXT)</p>

        <p><strong>Sample Results:</strong></p>
        <div class="result-box">
            <div class="result-item">1. <strong>Alien: Romulus</strong> | Rating: 7.2 | Year: 2024 | Relevance: 7.97</div>
            <div class="result-item">2. <strong>Interstellar</strong> | Rating: 8.5 | Year: 2014 | Relevance: 3.98</div>
            <div class="result-item">3. <strong>WALL·E</strong> | Rating: 8.1 | Year: 2008 | Relevance: 3.98</div>
            <div class="result-item">4. <strong>The Fantastic 4: First Steps</strong> | Rating: 7.0 | Year: 2025 | Relevance: 3.98</div>
            <div class="result-item">5. <strong>Elio</strong> | Rating: 7.0 | Year: 2025 | Relevance: 3.98</div>
        </div>

        <!-- QUERY 2 -->
        <h3>4.2 Query 2: Full-Text Search by Movie Title</h3>
        <p><span class="badge badge-fulltext">FULLTEXT</span></p>
        <p><strong>Purpose:</strong> Search for movies with titles matching or similar to a search term.</p>
        <p><strong>Use Case:</strong> User searches for "Star" to find Star Wars and other star-related movies.</p>

        <div class="sql-code">
<span class="sql-keyword">SELECT</span>
    m.title,
    m.vote_average <span class="sql-keyword">AS</span> rating,
    <span class="sql-keyword">YEAR</span>(m.release_date) <span class="sql-keyword">AS</span> year,
    m.popularity,
    <span class="sql-keyword">MATCH</span>(m.title) <span class="sql-keyword">AGAINST</span>(<span class="sql-string">'Star'</span>) <span class="sql-keyword">AS</span> relevance_score
<span class="sql-keyword">FROM</span>
    movies m
<span class="sql-keyword">WHERE</span>
    <span class="sql-keyword">MATCH</span>(m.title) <span class="sql-keyword">AGAINST</span>(<span class="sql-string">'Star'</span> <span class="sql-keyword">IN NATURAL LANGUAGE MODE</span>)
<span class="sql-keyword">ORDER BY</span>
    relevance_score <span class="sql-keyword">DESC</span>,
    m.popularity <span class="sql-keyword">DESC</span>
<span class="sql-keyword">LIMIT</span> 20;
        </div>

        <p><strong>Index Used:</strong> <span class="highlight">idx_movie_title</span> (FULLTEXT)</p>

        <p><strong>Sample Results:</strong></p>
        <div class="result-box">
            <div class="result-item">1. <strong>Star Wars</strong> | Rating: 8.2 | Year: 1977 | Popularity: 29.4</div>
        </div>

        <!-- QUERY 3 -->
        <h3>4.3 Query 3: Top-Rated Genres with Revenue Analysis</h3>
        <p><span class="badge badge-complex">COMPLEX</span> - Uses: GROUP BY, Aggregation, HAVING, Multiple Joins</p>
        <p><strong>Purpose:</strong> Analyze which genres produce the highest-rated content and their commercial performance.</p>
        <p><strong>Use Case:</strong> Find genres with at least 20 movies, showing average rating, movie count, and total revenue.</p>

        <div class="sql-code">
<span class="sql-keyword">SELECT</span>
    g.genre_name,
    <span class="sql-keyword">ROUND</span>(<span class="sql-keyword">AVG</span>(m.vote_average), 2) <span class="sql-keyword">AS</span> avg_rating,
    <span class="sql-keyword">COUNT</span>(<span class="sql-keyword">DISTINCT</span> m.movie_id) <span class="sql-keyword">AS</span> movie_count,
    <span class="sql-keyword">SUM</span>(m.revenue) <span class="sql-keyword">AS</span> total_revenue,
    <span class="sql-keyword">ROUND</span>(<span class="sql-keyword">AVG</span>(m.revenue), 0) <span class="sql-keyword">AS</span> avg_revenue
<span class="sql-keyword">FROM</span>
    genres g
    <span class="sql-keyword">INNER JOIN</span> movie_genres mg <span class="sql-keyword">ON</span> g.genre_id = mg.genre_id
    <span class="sql-keyword">INNER JOIN</span> movies m <span class="sql-keyword">ON</span> mg.movie_id = m.movie_id
<span class="sql-keyword">WHERE</span>
    m.vote_average <span class="sql-keyword">IS NOT NULL</span>
<span class="sql-keyword">GROUP BY</span>
    g.genre_id,
    g.genre_name
<span class="sql-keyword">HAVING</span>
    <span class="sql-keyword">COUNT</span>(<span class="sql-keyword">DISTINCT</span> m.movie_id) >= 20
<span class="sql-keyword">ORDER BY</span>
    avg_rating <span class="sql-keyword">DESC</span>,
    movie_count <span class="sql-keyword">DESC</span>;
        </div>

        <p><strong>Indices Used:</strong> <span class="highlight">idx_movie_genres_genre</span>, <span class="highlight">idx_movie_vote_average</span></p>

        <p><strong>Sample Results:</strong></p>
        <div class="result-box">
            <div class="result-item">1. <strong>Animation</strong> | Avg Rating: 7.26 | Movies: 75 | Total Revenue: $32,323,910,888 | Avg Revenue: $430,985,478</div>
            <div class="result-item">2. <strong>Drama</strong> | Avg Rating: 7.07 | Movies: 142 | Total Revenue: $23,040,959,331 | Avg Revenue: $162,260,979</div>
            <div class="result-item">3. <strong>Mystery</strong> | Avg Rating: 7.04 | Movies: 34 | Total Revenue: $4,672,801,448 | Avg Revenue: $137,435,337</div>
            <div class="result-item">4. <strong>Adventure</strong> | Avg Rating: 7.00 | Movies: 156 | Total Revenue: $90,115,754,088 | Avg Revenue: $577,536,885</div>
            <div class="result-item">5. <strong>Family</strong> | Avg Rating: 7.00 | Movies: 95 | Total Revenue: $35,498,392,461 | Avg Revenue: $373,667,289</div>
        </div>

        <!-- QUERY 4 -->
        <h3>4.4 Query 4: Actor Collaboration Finder</h3>
        <p><span class="badge badge-complex">COMPLEX</span> - Uses: Self-Join, GROUP BY, HAVING, Aggregation</p>
        <p><strong>Purpose:</strong> Find actors who frequently work together in multiple movies.</p>
        <p><strong>Use Case:</strong> Find all actors who appeared in at least 2 movies with Tom Hanks.</p>

        <div class="sql-code">
<span class="sql-keyword">SELECT</span>
    p2.name <span class="sql-keyword">AS</span> collaborator_name,
    <span class="sql-keyword">COUNT</span>(<span class="sql-keyword">DISTINCT</span> mc2.movie_id) <span class="sql-keyword">AS</span> collaboration_count,
    <span class="sql-keyword">GROUP_CONCAT</span>(
        <span class="sql-keyword">DISTINCT</span> m.title
        <span class="sql-keyword">ORDER BY</span> m.vote_average <span class="sql-keyword">DESC</span>
        <span class="sql-keyword">SEPARATOR</span> <span class="sql-string">', '</span>
    ) <span class="sql-keyword">AS</span> movie_titles
<span class="sql-keyword">FROM</span>
    people p1
    <span class="sql-keyword">INNER JOIN</span> movie_cast mc1 <span class="sql-keyword">ON</span> p1.person_id = mc1.person_id
    <span class="sql-keyword">INNER JOIN</span> movie_cast mc2 <span class="sql-keyword">ON</span> mc1.movie_id = mc2.movie_id
    <span class="sql-keyword">INNER JOIN</span> people p2 <span class="sql-keyword">ON</span> mc2.person_id = p2.person_id
    <span class="sql-keyword">INNER JOIN</span> movies m <span class="sql-keyword">ON</span> mc1.movie_id = m.movie_id
<span class="sql-keyword">WHERE</span>
    p1.name <span class="sql-keyword">LIKE</span> <span class="sql-string">'%Tom Hanks%'</span>
    <span class="sql-keyword">AND</span> p2.person_id != p1.person_id
<span class="sql-keyword">GROUP BY</span>
    p2.person_id,
    p2.name
<span class="sql-keyword">HAVING</span>
    <span class="sql-keyword">COUNT</span>(<span class="sql-keyword">DISTINCT</span> mc2.movie_id) >= 2
<span class="sql-keyword">ORDER BY</span>
    collaboration_count <span class="sql-keyword">DESC</span>,
    p2.name
<span class="sql-keyword">LIMIT</span> 20;
        </div>

        <p><strong>Indices Used:</strong> <span class="highlight">idx_movie_cast_person</span>, <span class="highlight">idx_people_name</span></p>

        <p><strong>Sample Results:</strong></p>
        <div class="result-box">
            <div class="result-item">1. <strong>Michael Jeter</strong> | Collaborations: 2 | Movies: The Green Mile, The Polar Express</div>
        </div>

        <!-- QUERY 5 -->
        <h3>4.5 Query 5: Director's Highest-Rated Films with Cast</h3>
        <p><span class="badge badge-complex">COMPLEX</span> - Uses: Nested Subquery, Multiple Joins, Aggregation, GROUP_CONCAT</p>
        <p><strong>Purpose:</strong> Explore a director's best work with top-billed actors.</p>
        <p><strong>Use Case:</strong> Find Christopher Nolan's films rated 7.0 or higher, showing top 3 cast members.</p>

        <div class="sql-code">
<span class="sql-keyword">SELECT</span>
    m.title,
    m.vote_average <span class="sql-keyword">AS</span> rating,
    <span class="sql-keyword">YEAR</span>(m.release_date) <span class="sql-keyword">AS</span> year,
    m.revenue,
    (
        <span class="sql-keyword">SELECT</span>
            <span class="sql-keyword">GROUP_CONCAT</span>(p_cast.name <span class="sql-keyword">ORDER BY</span> mc.cast_order <span class="sql-keyword">SEPARATOR</span> <span class="sql-string">', '</span>)
        <span class="sql-keyword">FROM</span>
            movie_cast mc
            <span class="sql-keyword">INNER JOIN</span> people p_cast <span class="sql-keyword">ON</span> mc.person_id = p_cast.person_id
        <span class="sql-keyword">WHERE</span>
            mc.movie_id = m.movie_id
            <span class="sql-keyword">AND</span> mc.cast_order < 3
        <span class="sql-keyword">ORDER BY</span>
            mc.cast_order
    ) <span class="sql-keyword">AS</span> top_cast
<span class="sql-keyword">FROM</span>
    movies m
    <span class="sql-keyword">INNER JOIN</span> movie_crew mcr <span class="sql-keyword">ON</span> m.movie_id = mcr.movie_id
    <span class="sql-keyword">INNER JOIN</span> people p_dir <span class="sql-keyword">ON</span> mcr.person_id = p_dir.person_id
<span class="sql-keyword">WHERE</span>
    p_dir.name <span class="sql-keyword">LIKE</span> <span class="sql-string">'%Christopher Nolan%'</span>
    <span class="sql-keyword">AND</span> mcr.job = <span class="sql-string">'Director'</span>
    <span class="sql-keyword">AND</span> m.vote_average >= 7.0
<span class="sql-keyword">GROUP BY</span>
    m.movie_id,
    m.title,
    m.vote_average,
    m.release_date,
    m.revenue
<span class="sql-keyword">ORDER BY</span>
    m.vote_average <span class="sql-keyword">DESC</span>
<span class="sql-keyword">LIMIT</span> 20;
        </div>

        <p><strong>Indices Used:</strong> <span class="highlight">idx_movie_crew_person_job</span>, <span class="highlight">idx_movie_vote_average</span>, <span class="highlight">idx_movie_cast_order</span></p>

        <p><strong>Sample Results:</strong></p>
        <div class="result-box">
            <div class="result-item">1. <strong>Interstellar</strong> | Rating: 8.5 | Year: 2014 | Cast: Matthew McConaughey, Anne Hathaway, Michael Caine</div>
            <div class="result-item">2. <strong>The Dark Knight</strong> | Rating: 8.5 | Year: 2008 | Cast: Christian Bale, Heath Ledger, Aaron Eckhart</div>
            <div class="result-item">3. <strong>Inception</strong> | Rating: 8.4 | Year: 2010 | Cast: Leonardo DiCaprio, Joseph Gordon-Levitt, Ken Watanabe</div>
            <div class="result-item">4. <strong>Oppenheimer</strong> | Rating: 8.0 | Year: 2023 | Cast: Cillian Murphy, Emily Blunt, Matt Damon</div>
            <div class="result-item">5. <strong>The Dark Knight Rises</strong> | Rating: 7.8 | Year: 2012 | Cast: Christian Bale, Gary Oldman, Tom Hardy</div>
        </div>

        <!-- CODE STRUCTURE -->
        <h2>5. Code Structure and API Usage</h2>

        <h3>5.1 Python Scripts Overview</h3>
        <p>The project consists of 4 main Python scripts, each with a specific responsibility:</p>

        <table>
            <thead>
                <tr>
                    <th>Script</th>
                    <th>Purpose</th>
                    <th>Key Functions</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>create_db_script.py</strong></td>
                    <td>Database schema creation</td>
                    <td>
                        • create_database()<br>
                        • create_tables()<br>
                        • create_indices()<br>
                        • show_schema_info()
                    </td>
                </tr>
                <tr>
                    <td><strong>api_data_retrieve.py</strong></td>
                    <td>TMDb API data fetching and insertion</td>
                    <td>
                        • fetch_genres()<br>
                        • fetch_discover_movies()<br>
                        • fetch_movie_details()<br>
                        • insert_movie(), insert_person(), etc.<br>
                        • populate_database()
                    </td>
                </tr>
                <tr>
                    <td><strong>queries_db_script.py</strong></td>
                    <td>Query function implementations</td>
                    <td>
                        • query_1(connection, keywords)<br>
                        • query_2(connection, search_term)<br>
                        • query_3(connection, min_movies)<br>
                        • query_4(connection, actor_name, min_collaborations)<br>
                        • query_5(connection, director_name, min_rating)
                    </td>
                </tr>
                <tr>
                    <td><strong>queries_execution.py</strong></td>
                    <td>Example query invocations</td>
                    <td>
                        • execute_query_1_examples()<br>
                        • execute_query_2_examples()<br>
                        • execute_query_3_examples()<br>
                        • execute_query_4_examples()<br>
                        • execute_query_5_examples()<br>
                        • main()
                    </td>
                </tr>
            </tbody>
        </table>

       <h3>5.2 API Integration Strategy</h3>
        <p><strong>Source:</strong> The Movie Database (TMDb) API v3.</p>
        <table>
            <thead><tr><th>Endpoint</th><th>Purpose</th><th>Mapping Strategy</th></tr></thead>
            <tbody>
                <tr><td><code>/genre/movie/list</code></td><td>Genre Reference</td><td>Populates <code>genres</code> table.</td></tr>
                <tr><td><code>/discover/movie</code></td><td>Batch Retrieval</td><td>Iterates through pages to find top 500 popular movies.</td></tr>
                <tr><td><code>/movie/{id}</code></td><td>Deep Details</td><td>Fetches runtime, budget, revenue for <code>movies</code> table.</td></tr>
                <tr><td><code>...credits</code></td><td>Cast & Crew</td><td>Mapped to <code>movie_cast</code> (limit top 8) and <code>movie_crew</code> (filtered by Job).</td></tr>
            </tbody>
        </table>
        <p><em>Note: The scripts implement rate limiting (4 req/sec) and transaction management (commit/rollback) to ensure data consistency.</em></p>
    </div>
</body>
</html>